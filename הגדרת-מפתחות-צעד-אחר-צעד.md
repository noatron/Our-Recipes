# הגדרת מפתחות – צעד אחר צעד

עקבי אחרי הצעדים **לפי הסדר**. כל צעד מסתיים כשהמשימה שלו הושלמה.

---

## שלב 1: לשמור את ערכי Firebase אצלך (להעתקה אחר כך)

1. פתחי את הקובץ **firebase.js** בפרויקט (הוא עדיין קיים אצלך במחשב).
2. העתיקי למקום בטוח (פנקס רשימות, קובץ זמני) את **שש השורות** האלה בדיוק כמו שהן:
   - `apiKey: "..."`  (כולל המרכאות)
   - `authDomain: "..."`
   - `projectId: "..."`
   - `storageBucket: "..."`
   - `messagingSenderId: "..."`
   - `appId: "..."`

**למה:** אחרי הצעד הבא הקובץ firebase.js לא יעלה יותר ל-Git, ואת תצטרכי להזין את הערכים ב-Netlify. עכשיו את שומרת עותק.

---

## שלב 2: להגדיר משתנים ב-Netlify

1. גלשי ל־**https://app.netlify.com** והתחברי.
2. בחרי את האתר של המתכונים (playful-mooncake וכו').
3. בתפריט השמאלי: **Site configuration** (או "Site settings").
4. בתפריט המשני: **Environment variables** (או "Build & deploy" → "Environment").
5. לוחצים **"Add a variable"** או **"Add environment variables"** / **"New variable"**.
6. מוסיפים **6 משתנים**, אחד אחד. לכל משתנה:
   - **Key** = השם בדיוק כמו שכתוב למטה (העתקה)
   - **Value** = הערך מהשורה המתאימה ב-firebase.js (בלי השדה, רק התוכן)
   - **Scopes**: להשאיר "All" או "Production"

**הרשימה – להעתיק את שמות ה-Keys:**

| מס' | Key (שם המשתנה)        | מאיפה לקחת את ה-Value |
|-----|-------------------------|-------------------------|
| 1   | `FIREBASE_API_KEY`      | מתוך apiKey: "הערך_כאן" (בלי המרכאות החיצוניות) |
| 2   | `FIREBASE_AUTH_DOMAIN`  | מתוך authDomain |
| 3   | `FIREBASE_PROJECT_ID`   | מתוך projectId |
| 4   | `FIREBASE_STORAGE_BUCKET` | מתוך storageBucket |
| 5   | `FIREBASE_MESSAGING_SENDER_ID` | מתוך messagingSenderId |
| 6   | `FIREBASE_APP_ID`       | מתוך appId |

**דוגמה:**  
אם ב-firebase.js כתוב:  
`apiKey: "הערך_שלך"`  
אז ב-Netlify:  
- Key: `FIREBASE_API_KEY`  
- Value: הערך מתוך המרכאות (המפתח האמיתי)

7. אחרי שהוספת את כל 6 – לוחצים **Save** או סוגרים את החלון (Netlify שומר אוטומטית).

**בודקים:** ברשימת Environment variables אמורים להופיע ששת השמות למעלה (הערך יכול להיות מוסתר עם נקודות).

---

## שלב 3: להפסיק להעלות את firebase.js ל-Git

עכשיו אנחנו אומרים ל-Git "תפסיק לעקוב אחרי הקובץ firebase.js" – הוא יישאר אצלך במחשב אבל לא יעלה יותר ל-GitHub.

1. פתחי **טרמינל** (ב-Cursor: Terminal → New Terminal, או Terminal במחשב).
2. וודאי שאת בתיקיית הפרויקט. הקלידי:
   ```bash
   cd /Users/noat/Desktop/simple-recipe-app
   ```
   ולחצי Enter.
3. הקלידי בדיוק:
   ```bash
   git rm --cached firebase.js
   ```
   ולחצי Enter.  
   אמורה להופיע הודעה בסגנון: `rm 'firebase.js'`.
4. עכשיו לעשות commit:
   ```bash
   git add .
   git commit -m "Generate firebase.js from env; stop tracking the file"
   ```
   Enter.
5. לעשות push:
   ```bash
   git push
   ```
   Enter.

**אם יש שגיאה ב-push** (למשל "rejected" או "failed") – העתיקי את כל השורות מהטרמינל ושלחי, ונמשיך משם.

---

## שלב 4: לוודא ש-Netlify עשה deploy חדש

1. חזרי ל־**Netlify** (בדפדפן).
2. באותו אתר: **Deploys** (בתפריט למעלה או בצד).
3. אמורה להופיע deploy חדש שהתחיל אחרי ה-push (למשל "Building" ואז "Published").
4. אם ה-build **נכשל** (אדום):
   - לחצי על ה-deploy שנכשל.
   - קראי את הודעת השגיאה (בדרך כלל "Missing environment variables" או רשימת משתנים).
   - חזרי ל-**Environment variables** וודאי שכל 6 שמות המשתנים קיימים וכתובים **בדיוק** כמו ברשימה (כולל רווחים גדולים/קטנים).
5. אם ה-build **הצליח** (ירוק Published) – עברי לשלב 5.

---

## שלב 5: לבדוק שהאתר עובד

1. פתחי את כתובת האתר (למשל https://playful-mooncake-8180bd.netlify.app/).
2. רענני את הדף (Cmd+Shift+R או F5).
3. בודקים:
   - האם עמוד המתכונים נטען?
   - האם רואים מתכונים (או "לא נמצאו מתכונים") ולא מסך ריק עם שגיאה?

אם כן – **סיימנו בחלק של Netlify.**

---

## שלב 6: פיתוח מקומי (כשאת עובדת על המחשב)

כדי שהאפליקציה תעבוד **אצלך במחשב** (localhost), צריך ש-firebase.js יהיה קיים. הוא לא עולה מ-Git אז צריך ליצור אותו פעם אחת מהמשתנים.

**אפשרות א – הכי פשוטה:**

1. בתיקיית הפרויקט צרי קובץ בשם **.env** (נקודה בהתחלה).
2. פתחי אותו בעורך וכתבי שורה אחת לכל משתנה, בפורמט:
   ```
   FIREBASE_API_KEY=הערך_שלך_בלי_מרכאות
   FIREBASE_AUTH_DOMAIN=our-recipes-1d97e.firebaseapp.com
   FIREBASE_PROJECT_ID=our-recipes-1d97e
   FIREBASE_STORAGE_BUCKET=our-recipes-1d97e.firebasestorage.app
   FIREBASE_MESSAGING_SENDER_ID=34335322566
   FIREBASE_APP_ID=1:34335322566:web:290e1438e050a7353882c7
   ```
   (החליפי את הערכים אם שונים אצלך.)
3. שמרי את הקובץ. **אל תעלי את .env ל-Git** – הוא כבר ב-.gitignore.
4. בטרמינל, מתוך תיקיית הפרויקט:
   ```bash
   node --env-file=.env scripts/generate-firebase-config.js
   ```
   אם מופיעה שגיאה כמו `--env-file is not supported`, עברי לאפשרות ב.
5. אמורה להופיע הודעה: `Written .../firebase.js`.
6. מעכשיו אפשר להריץ שרת מקומי (למשל `npx serve . -l 3000` או `python3 -m http.server 5500`) ולפתוח את האתר – הוא ישתמש ב-firebase.js שנוצר.

**אפשרות ב – אם Node לא תומך ב---env-file:**

1. התקיני חבילה קטנה:
   ```bash
   npm init -y
   npm install dotenv
   ```
2. הרצה:
   ```bash
   node -r dotenv/config scripts/generate-firebase-config.js
   ```
   (וודאי שיש קובץ .env עם כל 6 המשתנים כמו למעלה.)

---

## סיכום

| שלב | מה עשית |
|-----|---------|
| 1 | שמרת עותק של ערכי Firebase |
| 2 | הוספת 6 משתני סביבה ב-Netlify |
| 3 | הרצת `git rm --cached firebase.js` ו-commit + push |
| 4 | וידאת ש-Netlify עשה deploy מוצלח |
| 5 | בדקת שהאתר החי עובד |
| 6 | יצרת .env ו-firebase.js מקומית (לעבודה על המחשב) |

מעכשיו המפתחות לא נמצאים בקוד ב-GitHub – רק ב-Netlify (ובקובץ .env אצלך, שלא עולה ל-Git).

אם את נתקעת באיזה שלב – כתבי באיזה מספר שלב ומה בדיוק קורה (או העתיקי הודעת שגיאה), ונמשיך משם.
